# -- Overview --

# Per-account stuff goes in this file.  This particular instance will hold
# details for several gmail accounts, as well as facilities to switch among
# accounts quickly.  This file formerly contained passwords, but now should
# only contain references to a password manager.  (pass)

# Gmail is assumed.

# Setup:
#
# 1.  Replace the string "account1" with your primary username, in Initial
# Settings, in Folder Hooks, and in Account Switching Shortcuts.
#
# 2.  Replace the string "account2" with an additional username, in Folder
# Hooks and Account Switching Shortcuts, and so on for additional accounts.
#
# 3.  Use pass to set a password for each account.  Make sure the path in the
# password store matches the path specified in the "pass show ..." command, in
# all three sections.

# -- /Overview --


# -- Initial Settings --

  # This must be identical to the settings under Folder Hooks for account1.
  # Just setting the folder initially (as opposed to changing after startup)
  # doesn't trigger the folder hook.

  set \
    realname      = "Aaron Bugher" \
    use_from      = "yes" \
    from          = "account1@gmail.com" \
    folder        = "imaps://account1@imap.gmail.com/INBOX" \
    record        = "imaps://account1@imap.gmail.com/[Gmail]/Sent Mail" \
    postponed     = "imaps://account1@imap.gmail.com/[Gmail]/Drafts" \
    spoolfile     = "=" \
    imap_pass     = "`pass show gmail/account1/password`" \
    smtp_url      = "smtps://account1@smtp.gmail.com" \
    smtp_pass     = $imap_pass

# -- /Initial Settings --


# -- Folder Hooks --
  
  # account1:
  # 
  # This must be kept identical to the options under "Initial Settings".
  folder-hook "imaps://account1@imap.gmail.com/INBOX" ' \
    set \
    realname      = "Aaron Bugher" \
    use_from      = "yes" \
    from          = "account1@gmail.com" \
    folder        = "imaps://account1@imap.gmail.com/INBOX" \
    record        = "imaps://account1@imap.gmail.com/[Gmail]/Sent Mail" \
    postponed     = "imaps://account1@imap.gmail.com/[Gmail]/Drafts" \
    spoolfile     = "=" \
    imap_pass     = "`pass show gmail/account1/password`" \
    smtp_url      = "smtps://account1@smtp.gmail.com" \
    smtp_pass     = $imap_pass \
  '

  # account2:
  folder-hook "imaps://account2@imap.gmail.com/INBOX" ' \
    set \
    realname      = "Aaron Bugher"  \
    use_from      = yes \
    from          = "account2@gmail.com" \
    folder        = "imaps://account2@imap.gmail.com/INBOX" \
    record        = "imaps://account2@imap.gmail.com/[Gmail]/Sent Mail" \
    postponed     = "imaps://account2@imap.gmail.com/[Gmail]/Drafts" \
    spoolfile     = "=" \
    imap_pass     = "`pass show gmail/account2/password`" \
    smtp_url      = "smtps://account2@smtp.gmail.com" \
    smtp_pass     = $imap_pass \
  '

  # account3:
  folder-hook "imaps://account3@imap.gmail.com/INBOX" ' \
    set \
    realname      = "Aaron Bugher"  \
    use_from      = yes \
    from          = "account3@gmail.com" \
    folder        = "imaps://account3@imap.gmail.com/INBOX" \
    record        = "imaps://account3@imap.gmail.com/[Gmail]/Sent Mail" \
    postponed     = "imaps://account3@imap.gmail.com/[Gmail]/Drafts" \
    spoolfile     = "=" \
    imap_pass     = "`pass show gmail/account3/password`" \
    smtp_url      = "smtps://account3@smtp.gmail.com" \
    smtp_pass     = $imap_pass \
  '

# -- /Folder Hooks --


# -- Account Switching Shortcuts --

  # Make it easy to switch between accounts (<esc> 1, <esc> 2).

  # %20 for a space in the name.  I haven't found a way to get it right with
  # quoting or backslash escaping.

  # Password variables are set after the folder change.  These lines,
  # specifying how to change folders, must specify the password in-line.

  macro index \e1 <change-folder>imaps://account1:`pass show gmail/account1/password`@imap.gmail.com/[Gmail]/All%20Mail<enter>
  macro index \e2 <change-folder>imaps://account2:`pass show gmail/account2/password`@imap.gmail.com/[Gmail]/All%20Mail<enter>
  macro index \e3 <change-folder>imaps://account3:`pass show gmail/account3/password`@imap.gmail.com/[Gmail]/All%20Mail<enter>

# -- /Account Switching Shortcuts --
